# 需求文档

## 介绍

意启是一个基于AI的头脑风暴平台，专门用于设计文创产品。用户可以配置多个AI代理（agent），每个代理扮演不同的角色（如设计师、市场调研员、文化调研员、工程师、营销人员等），然后通过结构化的三阶段头脑风暴流程，生成从设计稿到成品稿和营销方案的完整产品解决方案。

## 需求

### 需求 1 - 用户认证与管理

**用户故事：** 作为用户，我希望能够注册和登录系统，以便管理我的AI代理和头脑风暴会话。

#### 验收标准

1. WHEN 用户访问注册页面 THEN 系统 SHALL 提供用户名、密码输入字段
2. WHEN 用户提交有效的注册信息 THEN 系统 SHALL 创建新用户账户
3. WHEN 用户使用正确的凭据登录 THEN 系统 SHALL 验证用户身份并创建会话
4. WHEN 用户登录失败超过5次 THEN 系统 SHALL 临时锁定账户15分钟

### 需求 2 - AI代理配置与管理

**用户故事：** 作为用户，我希望能够创建和配置多个AI代理，每个代理有不同的角色和系统提示词，以便在头脑风暴中扮演不同的专业角色。

#### 验收标准

1. WHEN 用户创建新代理 THEN 系统 SHALL 允许设置代理名称、角色类型、系统提示词和AI模型选择
2. WHEN 用户保存代理配置 THEN 系统 SHALL 验证配置完整性并存储到数据库
3. WHEN 用户编辑现有代理 THEN 系统 SHALL 保留历史版本并更新当前配置
4. WHEN 用户删除代理 THEN 系统 SHALL 检查是否有正在进行的会话使用该代理
5. IF 代理被正在进行的会话使用 THEN 系统 SHALL 阻止删除操作
6. WHEN 用户查看代理列表 THEN 系统 SHALL 显示所有代理的基本信息和状态

### 需求 3 - 头脑风暴会话管理

**用户故事：** 作为用户，我希望能够创建和管理头脑风暴会话，设定主题并选择参与的AI代理，以便进行结构化的创意讨论。

#### 验收标准

1. WHEN 用户创建新会话 THEN 系统 SHALL 允许设置会话标题、描述和选择参与的代理
2. WHEN 用户启动会话 THEN 系统 SHALL 初始化三个阶段：创意生成、技术可行性分析、缺点讨论
3. WHEN 用户发布主题 THEN 系统 SHALL 将主题广播给所有选定的代理
4. WHEN 会话进行中 THEN 系统 SHALL 跟踪当前阶段和每个代理的参与状态
5. WHEN 用户暂停会话 THEN 系统 SHALL 保存当前状态并允许稍后恢复

### 需求 4 - 并行AI推理处理

**用户故事：** 作为系统，我需要能够并行处理多个AI代理的推理请求，以便在头脑风暴过程中实现高效的多代理协作。

#### 验收标准

1. WHEN 主题发布给多个代理 THEN 系统 SHALL 使用多线程并行发送推理请求
2. WHEN AI推理请求发送 THEN 系统 SHALL 集成七牛云AI推理API进行实时处理
3. WHEN 所有代理完成当前阶段思考 THEN 系统 SHALL 收集所有响应并生成阶段总结
4. IF 某个代理推理失败 THEN 系统 SHALL 记录错误并继续处理其他代理的响应
5. WHEN 推理请求超时 THEN 系统 SHALL 标记该代理为超时状态并继续流程

### 需求 5 - 三阶段头脑风暴流程

**用户故事：** 作为用户，我希望系统能够引导我完成三个结构化的头脑风暴阶段，每个阶段都有明确的目标和输出。

#### 验收标准

1. WHEN 进入创意生成阶段 THEN 系统 SHALL 让每个代理从自己的职业角度针对用户主题进行独立头脑风暴
2. WHEN 创意生成阶段完成 THEN 系统 SHALL 收集所有代理的创意输出并生成阶段总结
3. WHEN 用户审核创意生成结果 AND 用户同意 THEN 系统 SHALL 进入技术可行性分析阶段
4. WHEN 用户审核创意生成结果 AND 用户不同意 THEN 系统 SHALL 重新进行创意生成阶段
5. WHEN 进入技术可行性分析阶段 THEN 系统 SHALL 让每个代理从自己的职业角度评判其他代理的创意想法
6. WHEN 技术可行性分析阶段完成 THEN 系统 SHALL 收集所有代理的分析输出并生成阶段总结
7. WHEN 用户审核技术可行性结果 AND 用户同意 THEN 系统 SHALL 进入缺点讨论阶段
8. WHEN 用户审核技术可行性结果 AND 用户不同意 THEN 系统 SHALL 重新进行技术可行性分析阶段
9. WHEN 进入缺点讨论阶段 THEN 系统 SHALL 让每个代理从自己的职业角度评判和讨论前面阶段的想法缺点
10. WHEN 缺点讨论阶段完成 THEN 系统 SHALL 收集所有代理的讨论输出并生成最终阶段总结
11. WHEN 用户审核缺点讨论结果 AND 用户同意 THEN 系统 SHALL 完成整个头脑风暴流程
12. WHEN 用户审核缺点讨论结果 AND 用户不同意 THEN 系统 SHALL 重新进行缺点讨论阶段

### 需求 6 - 结果报告生成

**用户故事：** 作为用户，我希望系统能够生成完整的产品解决方案报告，包括设计稿、成品稿和营销方案。

#### 验收标准

1. WHEN 所有三个阶段完成 THEN 系统 SHALL 整合所有代理的输出生成最终报告
2. WHEN 生成最终报告 THEN 系统 SHALL 包含设计概念、技术方案、营销策略等完整内容
3. WHEN 报告生成完成 THEN 系统 SHALL 支持PDF导出和在线查看功能
4. WHEN 用户查看历史报告 THEN 系统 SHALL 提供报告列表和搜索功能
5. WHEN 报告包含图像需求 THEN 系统 SHALL 集成阿里云图像生成API创建视觉内容

### 需求 7 - 系统集成与API管理

**用户故事：** 作为系统管理员，我需要系统能够稳定集成外部AI服务，确保推理请求的可靠性和性能。

#### 验收标准

1. WHEN 系统启动 THEN 系统 SHALL 验证七牛云AI推理API的连接和认证
2. WHEN 发送推理请求 THEN 系统 SHALL 实现请求重试机制和错误处理
3. WHEN API调用频率过高 THEN 系统 SHALL 实现请求限流和队列管理
4. WHEN 需要批量处理 THEN 系统 SHALL 支持七牛云批量任务推理API
5. WHEN 生成图像内容 THEN 系统 SHALL 集成阿里云Qwen图像生成模型

